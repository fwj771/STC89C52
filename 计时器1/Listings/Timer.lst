C51 COMPILER V9.54   TIMER                                                                 10/16/2025 23:21:37 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\Objects\Timer.obj
COMPILER INVOKED BY: D:\Keil\Keil5 C51\C51\BIN\C51.EXE Timer.c OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\Listings\Time
                    -r.lst) TABS(2) OBJECT(.\Objects\Timer.obj)

line level    source

   1          #include <REGX52.H>
   2          
   3          
   4          // 外部变量声明
   5          extern volatile bit flag_1s;
   6          extern volatile bit flag_500ms;
   7          extern volatile bit blinkState;
   8          
   9          
  10          /**
  11            * @brief  定时器0初始化 1ms
  12            * @param  无
  13            * @retval 无
  14            */
  15          void Timer0_Init(void)
  16          {
  17   1        TMOD &= 0xF0;     // 清除T0的控制位
  18   1        TMOD |= 0x01;     // 设置T0为模式1（16位定时器）
  19   1        TL0 = 0x18;       // 设置定时初值（1ms@12MHz）
  20   1        TH0 = 0xFC;       // 设置定时初值
  21   1        TF0 = 0;          // 清除溢出标志
  22   1        TR0 = 1;          // 启动定时器0
  23   1        
  24   1        ET0 = 1;          // 允许定时器0中断
  25   1        EA = 1;           // 开启总中断
  26   1        PT0 = 0;          // 设置定时器0中断优先级为低
  27   1        
  28   1      }
  29          
  30          /**
  31            * @brief  定时器0中断服务函数模板
  32            * @param  无
  33            * @retval 无
  34            */
  35          //void Timer0_Isr(void) interrupt 1
  36          //{
  37          //  static unsigned int msCount = 0;
  38          
  39          //  TL0 = 0x18;
  40          //  TH0 = 0xFC;
  41          
  42          //  if(++msCount >= 1000) 1秒
  43          //  {
  44          //    msCount = 0;
  45          //    功能
  46          //  }
  47          
  48          //}
  49          void Timer0_Isr(void) interrupt 1
  50          {
  51   1        static unsigned int msCount = 0;
  52   1        static unsigned int blinkCount = 0;
  53   1      
  54   1        TL0 = 0x18;
C51 COMPILER V9.54   TIMER                                                                 10/16/2025 23:21:37 PAGE 2   

  55   1        TH0 = 0xFC;
  56   1      
  57   1        if(++msCount >= 1000)
  58   1        {
  59   2          msCount = 0;
  60   2          flag_1s = 1;  // 每秒触发一次
  61   2        }
  62   1      
  63   1        if(++blinkCount >= 500) 
  64   1        {
  65   2          blinkCount = 0;
  66   2          flag_500ms = 1; // 每500ms触发闪烁
  67   2        }
  68   1               
  69   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     91    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      4    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
