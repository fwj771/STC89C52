C51 COMPILER V9.54   DIGITALTUBE                                                           10/28/2025 19:08:51 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE DIGITALTUBE
OBJECT MODULE PLACED IN .\Objects\DigitalTube.obj
COMPILER INVOKED BY: D:\Keil\Keil5 C51\C51\BIN\C51.EXE DigitalTube.c OMF2 OPTIMIZE(8,SPEED) BROWSE DEBUG PRINT(.\Listing
                    -s\DigitalTube.lst) TABS(2) OBJECT(.\Objects\DigitalTube.obj)

line level    source

   1          #include <REGX52.H>
   2          #include "DelayMs.h"
   3          #include "MatrixKey.h"
   4          #include "LCD1602.h"
   5          
   6          sbit LSA = P2^2;
   7          sbit LSB = P2^3;
   8          sbit LSC = P2^4;
   9          
  10          unsigned char code digitalTube[17] = {
  11            0x3f,0x06,0x5b,0x4f,0x66,0x6d,0x7d,0x07,
  12            0x7f,0x6f,0x77,0x7c,0x39,0x5e,0x79,0x71,0x08//下划线
  13          }; // 段码表
  14          
  15          unsigned char i, j;
  16          unsigned char DisplayNum[8] = {16,16,16,16,16,16,16,16};  
  17          unsigned char Password[8]   = {1,2,3,4,5,6,7,8};
  18          unsigned char DigitalPos = 0;
  19          
  20          bit isCorrect = 0;
  21          bit flashFlag = 1;
  22          extern bit setMode;
  23          void DigDisplay()
  24          {
  25   1        for(i=0;i<8;i++)
  26   1        {
  27   2          switch(i)
  28   2          {
  29   3            case 0: LSA=1;LSB=1;LSC=1;break;
  30   3            case 1: LSA=0;LSB=1;LSC=1;break;
  31   3            case 2: LSA=1;LSB=0;LSC=1;break;
  32   3            case 3: LSA=0;LSB=0;LSC=1;break;
  33   3            case 4: LSA=1;LSB=1;LSC=0;break;
  34   3            case 5: LSA=0;LSB=1;LSC=0;break;
  35   3            case 6: LSA=1;LSB=0;LSC=0;break;
  36   3            case 7: LSA=0;LSB=0;LSC=0;break;
  37   3          }
  38   2          if(i == DigitalPos && DisplayNum[i] == 16) // 当前输入位闪烁
  39   2          {
  40   3            P0 = flashFlag ? digitalTube[16] : 0x00;
  41   3          }
  42   2          else
  43   2          {
  44   3            P0 = digitalTube[DisplayNum[i]];
  45   3          }   
  46   2          DelayMs(2);
  47   2          P0 = 0x00;
  48   2        }
  49   1      }
  50          
  51          void cleanPassword()
  52          {
  53   1        for(j=0; j<8; j++)
  54   1        {
C51 COMPILER V9.54   DIGITALTUBE                                                           10/28/2025 19:08:51 PAGE 2   

  55   2          DisplayNum[j] = 16;
  56   2        }
  57   1        DigitalPos = 0;
  58   1        LCD_ShowString(2, 1, "        "); 
  59   1      }
  60          
  61          void checkPassword()
  62          {
  63   1        if(DigitalPos < 8)
  64   1        {
  65   2          LCD_ShowString(2, 1, "INPUT..."); 
  66   2          return;
  67   2        }
  68   1        isCorrect = 0;  
  69   1        for(j=0; j<8; j++)
  70   1        {
  71   2          if(Password[j] != DisplayNum[j])
  72   2          {
  73   3            break;
  74   3          }
  75   2          if(j == 7)
  76   2          {
  77   3            isCorrect = 1;
  78   3          }
  79   2        }
  80   1      
  81   1        if(isCorrect)
  82   1        {
  83   2          cleanPassword();
  84   2          LCD_ShowString(2, 1, "ENTER   ");
  85   2        }
  86   1        else
  87   1        {
  88   2          cleanPassword();
  89   2          LCD_ShowString(2, 1, "WRONG   ");
  90   2        }
  91   1      }
  92          
  93          
  94          void DigitalInput()
  95          {
  96   1        unsigned char Num = MatrixKey_Scan();
  97   1      
  98   1        if(Num != 0xFF && DigitalPos < 8)
  99   1        {
 100   2          if(Num <= 9)
 101   2          {
 102   3            DisplayNum[DigitalPos] = Num;     
 103   3            if(DigitalPos < 8) DigitalPos++;
 104   3          }
 105   2        }
 106   1      }
 107          
 108          void setPassword()
 109          {
 110   1          static unsigned char tempPassword[8]; 
 111   1          static bit firstInput = 0;    
 112   1        
 113   1          if(DigitalPos == 8) 
 114   1          {
 115   2              if(firstInput == 0)
 116   2              {
C51 COMPILER V9.54   DIGITALTUBE                                                           10/28/2025 19:08:51 PAGE 3   

 117   3                  for(j = 0; j < 8; j++)
 118   3                  {
 119   4                      tempPassword[j] = DisplayNum[j];
 120   4                  }
 121   3                  cleanPassword();
 122   3                  LCD_ShowString(2, 1, "AGAIN!  "); 
 123   3                  firstInput = 1;
 124   3              }
 125   2              else
 126   2              {
 127   3                  bit match = 1;
 128   3                  for(j = 0; j < 8; j++)
 129   3                  {
 130   4                      if(tempPassword[j] != DisplayNum[j])
 131   4                      {
 132   5                          match = 0;
 133   5                          break;
 134   5                      }
 135   4                  }
 136   3      
 137   3                  cleanPassword();
 138   3      
 139   3                  if(match)
 140   3                  {
 141   4                      for(j = 0; j < 8; j++)
 142   4                      {
 143   5                          Password[j] = tempPassword[j];
 144   5                      }
 145   4                      LCD_ShowString(2, 1, "SAVED!  ");
 146   4                      setMode = 0;
 147   4                  }
 148   3                  else
 149   3                  {
 150   4                      LCD_ShowString(2, 1, "NOT SAME");
 151   4                  }
 152   3                  firstInput = 0;
 153   3              }
 154   2          }
 155   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    453    ----
   CONSTANT SIZE    =     80    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     27    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
